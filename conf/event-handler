conf="`dirname \"$0\"`"
shell=$1
shift 1

export WHIZBANG="`dirname \"${conf}\"`"

handle() {
	if [ ! -d "$1" ]; then return; fi
	for handler in "$1"/*; do
		if [ -e "$handler" ]; then
			case "$handler" in
				*.sh|*.${shell}	) . "$handler"	;;
				*.run			)   "$handler"	;;
				*.bg			)   "$handler"&	;;
			esac
		fi
	done
}

for event in "$@"; do
	handle "$WHIZBANG/user/${USER}/events/$event"
	handle "$WHIZBANG/user/_common/events/$event"
	handle "$WHIZBANG/user/_custom/events/$event"
done
